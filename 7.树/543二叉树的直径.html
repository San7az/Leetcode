<script>
  /**
   * Definition for a binary tree node.
   * function TreeNode(val, left, right) {
   *     this.val = (val===undefined ? 0 : val)
   *     this.left = (left===undefined ? null : left)
   *     this.right = (right===undefined ? null : right)
   * }
   */
  /**
   * @param {TreeNode} root
   * @return {number}
   */
  var diameterOfBinaryTree = function (root) {
    let maxDiameter = 0
    function getHeightAndDiameter(node) {
      if (node === null) {
        return { height: 0, diameter: 0 }
      }
      const left = getHeightAndDiameter(node.left)
      const right = getHeightAndDiameter(node.right)

      // 当前节点的直径是左右子树的高度之和
      const currentDiameter = left.height + right.height
      maxDiameter = Math.max(maxDiameter, currentDiameter)

      // 当前节点的高度是左右子树中较高者加一
      const currentHeight = Math.max(left.height, right.height) + 1
      return {
        height: currentHeight,
        diameter: maxDiameter,
      }
    }
    getHeightAndDiameter(root)
    return maxDiameter
  }
</script>
