<script>
  /**
   * @param {string} s
   * @return {number}
   */
  var countSubstrings = function (s) {
    let count = 0
    const n = s.length
    const dp = Array.from({ length: n }, () => Array(n).fill(false))

    // 长度为 1 的子串
    for (let i = 0; i < n; i++) {
      dp[i][i] = true
      count++
    }

    // 长度为 2 的子串
    for (let i = 0; i < n - 1; i++) {
      if (s[i] === s[i + 1]) {
        dp[i][i + 1] = true
        count++
      }
    }

    // 长度大于 2 的子串
    // 子串长度
    for (let len = 3; len <= n; len++) {
      // 子串起始位置
      for (let i = 0; i <= n - len; i++) {
        // 字子串结束位置
        let j = i + len - 1
        if (s[i] === s[j] && dp[i + 1][j - 1]) {
          dp[i][j] = true
          count++
        }
      }
    }
    return count
  }
</script>
